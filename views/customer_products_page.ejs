<div class="customer-products-container">
  <div class="customer-filter-form">
    <h2 id="formTitle">Filter Products</h2>
    <form id="filter" action="/customer-products" method="POST">
      <div class="form-group">
        <label for="productCategory">Category:</label>
        <select id="productCategory" name="categoryId">
          <option value="">All Categories</option>
          <% categories.forEach(function(category) { %>
          <option value="<%= category.id %>"><%= category.categoryName %></option>
          <% }); %>
        </select>
      </div>
      <div class="form-group">
        <label for="priceRange">Price Range:</label>
        <select id="priceRange" name="priceRange">
          <option value="">All Prices</option>
          <option value="0-20">$0 - $20</option>
          <option value="21-40">$21 - $40</option>
          <option value="41-60">$41 - $60</option>
          <option value="61-80">$61 - $80</option>
          <option value="81-100">$81 - $100</option>
        </select>
      </div>
      <div class="form-group">
        <label for="rating">Average Rating:</label>
        <select id="rating" name="rating">
          <option value="0">All Ratings</option>
          <option value="1">1 Star</option>
          <option value="2">2 Stars</option>
          <option value="3">3 Stars</option>
          <option value="4">4 Stars</option>
          <option value="5">5 Stars</option>
        </select>
      </div>
      <button type="submit">Filter Products</button>
    </form>
  </div>

  <div class="products-list-container">
    <!-- Search Field -->
    <input type="text" id="searchInput" placeholder="Search for products..." onkeyup="filterProducts()" />

    <!-- Products List -->
    <ul id="productList">
      <% products.forEach(function(product) { %>
      <li class="product-item" data-name="<%= product.name.toLowerCase() %>">
        <img src="<%= product.imageUrl %>" alt="<%= product.name %>" style="width: 100px" />
        <div>
          <h4><%= product.name %></h4>
          <p><%= product.description %></p>
          <p>Price: $<%= product.price.toFixed(2) %></p>
          <p>Stock: <%= product.stockQuantity %></p>
        </div>
        <div>
          <button onclick="location.href='/product-details/<%= product.id %>'">Details</button>
          <button onclick="">Cart</button>
        </div>
      </li>
      <% }); %> <% if (products.length === 0 ) { %>
      <li>No products found.</li>
      <% } %>
    </ul>
  </div>
</div>

<script>
  function filterProducts() {
    const input = document.getElementById("searchInput");
    const filter = input.value.toLowerCase();
    const productList = document.getElementById("productList");
    const products = productList.getElementsByClassName("product-item");

    Array.from(products).forEach(function (product) {
      const name = product.getAttribute("data-name");
      if (name.includes(filter)) {
        product.style.display = "";
      } else {
        product.style.display = "none";
      }
    });
  }
</script>
